drop table if exists tbl_2, tbl_7, tbl_8, tbl_9, tbl_11, tbl_14, tbl_15, tbl_16, tbl_20, tbl_21;
set @@tidb_isolation_read_engines = 'tiflash';
create table tbl_20 ( col_115 boolean   not null ,col_116 float   not null default 2862.5671249511674 ,col_117 double   not null default 433.4597649969197 ,col_118 time ,col_119 varchar ( 100 )    default 'EsgJ9j@*quHqpmAwp' ,col_120 text ( 186 )   not null ,col_121 tinyint ,col_122 mediumint   not null default -3999123 ,col_123 varchar ( 326 ) ,col_124 tinyint   not null , key idx_35 ( col_119 ( 2 ) ,col_121 ,col_118 ) ) charset utf8mb4 collate utf8mb4_bin partition by hash ( col_122 ) partitions 4;
insert ignore into tbl_20  values ( 1,6634.22334543761,9658.30202146338,'18:47:31.00','#4U-6!z#fBE*J','fm6i@',-15,7918669,'Xltt',-33 ) on duplicate key update col_116 = 8884.947765166835, col_119 = null, col_121 = 104, col_117 = 7253.076948432971, col_118 = '12:45:13.00', col_123 = '3inAX3BJ5S', col_122 = 1440161, col_120 = 'bS#g@6&~MB4', col_115 = 1, col_124 = -83;
select  /*+ agg_to_cop() stream_agg() */  sum( distinct  tbl_20.col_121 ) as r0 , avg( distinct  tbl_20.col_122      ) as r1 from tbl_20 where IsNull( tbl_20.col_118 ) and not( tbl_20.col_121 between 124 and 105 ) group by tbl_20     .col_121,tbl_20.col_122  order by r0,r1 ;
